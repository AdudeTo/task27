const searchField=document.getElementById("searchInput"),moviesListHolder=document.getElementById("moviesListHolder");let movieListAPI="https://api.tvmaze.com/search/",movieSearchCriteria="shows/",movieSearchQuery,movieLastSearch,movieCallConstructor;coolDown=500,coolDownLoading=0;let minCharacters=3,returnMessages=[];function printHTML(data){moviesListHolder.innerHTML="";let allItemsCont=data.length;if(!data.length){let item=document.createElement("LI");item.innerHTML=`\n            <h3>${returnMessages.noResults}</h3>\n        `,moviesListHolder.appendChild(item)}data.forEach(async movie=>{let item=document.createElement("LI");null==movie.show.rating.average?movie.show.rating.average=returnMessages.notRated:movie.show.rating.average=movie.show.rating.average+" stars",item.innerHTML=`\n            <figure>\n                <img alt="${movie.show.name}" src="${movie.show.image.medium}">\n            </figure>\n            <h3>${movie.show.name}</h3>\n            <h4>Rating: <span>${movie.show.rating.average}</span></h4>\n            <h5>${movie.show.genres.join(", ")}</h5>\n            ${movie.show.summary}\n        `,moviesListHolder.appendChild(item)})}function fetchmovieList(callback){fetch(movieCallConstructor).then(response=>response.json()).then(json=>callback(null,json)).catch(error=>callback(error,null))}function prepareAcall(){let getSearchQuery=searchField.value;searchField.value!=movieLastSearch&&getSearchQuery.length>=minCharacters&&!coolDownLoading&&(movieCallConstructor=`${movieListAPI}${movieSearchCriteria}?q=${getSearchQuery}`,fetchmovieList((error,data)=>{error?console.log(error):movieLastSearch=searchField.value,printHTML(data)}),coolDownLoading=1,setTimeout(()=>{coolDownLoading=0,prepareAcall()},coolDown))}returnMessages.notRated="not rated yet",returnMessages.noResults="No results available",searchField.addEventListener("keyup",event=>{"Enter"==event.key&&(coolDownLoading=0),prepareAcall()});